<!DOCTYPE html>
<html>

<head th:replace="~{base :: head('Gestão de Agrupadores')}"></head>

<body onLoad="onLoad()">
	<nav th:replace="~{base :: menu}"></nav>
	<div class="container" id="app">
	<div class="row">
			<div class="col">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Nome</th>
							<th>NIS</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="pessoa in pessoas.content">
							<td>{{pessoa.linhaOuRamal}}</td>
							<td>{{pessoa.local.nome}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>


		<nav aria-label="..." class="d-flex justify-content-center">
			<ul class="pagination">
				<li v-if="!pessoas.first" class="page-item "><a
					class="page-link" href="#" tabindex="-1" @click.prevent="goPrevius">Anterior</a></li>

				<li v-if="!pessoas.last" class="page-item"><a class="page-link"
					href="#" @click.prevent="goNext">Próxima</a></li>
			</ul>
		</nav>

		<div class="row mt-2">
			<div class="col d-flex justify-content-center">
				<a href="/home" class="btn btn-primary">Voltar</a>
			</div>
		</div>

	</div>

	<div th:replace="~{base :: myScripts}"></div>

	<script>
		function onLoad() {
			const app = new Vue(
				{
					el: '#app',
					data: {
						pessoas: [],
						count: 0,
						searchTerm: null,
						contextUrl: null,
					},
					mounted() {
						this.contextUrl = `${window.location.protocol}//${window.location.host}/api/v1/`
						this.execute();

					},
					methods: {
						goPrevius: function () {
							this.count--;
							this.execute();
						},
						goNext: function () {
							this.count++;
							this.execute();
						},
						execute: function () {
							axios
								.get(`${this.contextUrl}/produtos?page=${this.count}`)
								.then(response => (this.pessoas = response.data))
						},
						search: function (criteria) {
							if (criteria === null) {this.searchTerm = '';}
							axios
								.get(`${this.contextUrl}/beneficiarios?${criteria}=${this.searchTerm}`)
								.then(response => (this.pessoas = response.data))
						}
					}
				}
			)
		}
	</script>
	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
		integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
		crossorigin="anonymous"></script>



</body>

</html>